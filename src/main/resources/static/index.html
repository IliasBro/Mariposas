<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Mariposas - Schmetterlingsklassifikation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding: 2rem; background-color: #f8f9fa; }
        #preview { max-width: 300px; margin-top: 1rem; border-radius: 0.5rem; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        #resultCard { margin-top: 2rem; display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="mb-4">ü¶ã Mariposas</h1>
        <p>Lade ein Schmetterlingsbild hoch und erhalte eine Klassifikation.</p>

        <form>
            <div class="mb-3">
                <input class="form-control" type="file" id="image" accept="image/*" onchange="checkFiles(this.files)">
            </div>
        </form>

        <div id="previewPart" class="text-center">
            <img id="preview" src="#" alt="Vorschau" style="display: none;" />
        </div>

        <div id="resultCard" class="card">
            <div class="card-body">
                <h5 class="card-title">üîç Analyseergebnis</h5>
                <pre id="answer" class="mb-0"></pre>
            </div>
        </div>
    </div>

    <script>
        function checkFiles(files) {
            const preview = document.getElementById("preview");
            const answer = document.getElementById("answer");
            const resultCard = document.getElementById("resultCard");
        
            if (!files || files.length === 0) return;
        
            const file = files[0];
            preview.src = URL.createObjectURL(file);
            preview.style.display = "block";
        
            const formData = new FormData();
            formData.append("image", file);
        
            fetch('/analyze', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                let resultHTML = "<ul class='list-group'>";
                data.forEach(item => {
                    const percent = (item.probability * 100).toFixed(2);
                    resultHTML += `<li class='list-group-item d-flex justify-content-between align-items-center'>
                        <span>${item.className}</span>
                        <span class="badge bg-primary rounded-pill">${percent} %</span>
                    </li>`;
                });
                resultHTML += "</ul>";
        
                answer.innerHTML = resultHTML;
                resultCard.style.display = "block";
            })
            .catch(error => {
                answer.textContent = "Fehler: " + error;
                resultCard.style.display = "block";
            });
        }
        </script>
        
</body>
</html>
